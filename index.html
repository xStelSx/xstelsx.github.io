<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Генератор Word на GitHub Pages</title>
    <style>
        body { font-family: sans-serif; padding: 2rem; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; }
    </style>
    <!-- Подключаем библиотеку docx для создания настоящих .docx файлов -->
    <script src="https://cdn.jsdelivr.net/npm/docx@8.2/build/index.min.js"></script>
</head>
<body>
    <h2>Тест генерации Word-документов</h2>
    <p>Нажмите кнопку, чтобы сгенерировать и скачать файл.</p>

    <button id="simpleDoc">Скачать простой .doc (HTML)</button>
    <button id="realDocx">Скачать настоящий .docx</button>

    <script>
        // 1. Простой .doc – на самом деле это HTML-файл с расширением .doc
        document.getElementById('simpleDoc').addEventListener('click', function() {
            // Содержимое документа (можно использовать любой HTML)
            const content = `
                <html>
                    <head><meta charset="UTF-8"></head>
                    <body>
                        <h1 style="color: blue;">Привет из GitHub Pages!</h1>
                        <p>Этот документ создан прямо в браузере.</p>
                        <ul>
                            <li>Пункт первый</li>
                            <li>Пункт второй</li>
                        </ul>
                        <p><i>Текущее время: ${new Date().toLocaleString()}</i></p>
                    </body>
                </html>
            `;

            // Создаём Blob с типом application/msword
            const blob = new Blob([content], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);

            // Создаём ссылку и программно кликаем по ней
            const a = document.createElement('a');
            a.href = url;
            a.download = 'простой_документ.doc';  // расширение .doc
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url); // освобождаем память
        });

        // 2. Настоящий .docx с использованием библиотеки docx
        document.getElementById('realDocx').addEventListener('click', async function() {
            // Дожидаемся загрузки библиотеки (она уже подключена в head)
            const { Document, Packer, Paragraph, TextRun } = docx;

            // Создаём новый документ
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun("Привет, мир! "),
                                new TextRun({
                                    text: "Это жирный текст.",
                                    bold: true
                                }),
                                new TextRun({
                                    text: " А это курсив.",
                                    italics: true
                                })
                            ]
                        }),
                        new Paragraph("Ещё один параграф с простым текстом."),
                        new Paragraph({
                            children: [
                                new TextRun("Дата генерации: " + new Date().toLocaleString())
                            ]
                        })
                    ]
                }]
            });

            // Преобразуем документ в Blob
            const blob = await Packer.toBlob(doc);

            // Сохраняем файл
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'настоящий_документ.docx';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>
